# 用户使用指南

## 1. 快速开始

### 1.1 安装插件

#### 方式一：从Office商店安装（推荐）
1. 打开 Excel 或 Word
2. 点击 **插入** → **获取加载项**
3. 搜索 "考勤表生成器"
4. 点击 **添加** 完成安装

#### 方式二：侧载安装（开发/测试）
1. 下载插件包
2. 打开 Excel/Word
3. 点击 **插入** → **我的加载项** → **上传我的加载项**
4. 选择 `manifest.xml` 文件

### 1.2 启动插件

安装完成后，在 **开始** 选项卡中会出现 "考勤表生成器" 按钮，点击即可打开插件面板。

---

## 2. 核心功能

### 2.1 自然语言生成考勤表

这是插件的核心功能，您可以用自然语言描述需要的考勤表。

#### 使用方法
1. 在输入框中输入您的需求
2. 点击 **生成** 或按 Enter 键
3. 预览生成的考勤表
4. 确认后点击 **插入到文档**

#### 输入示例

**基础示例：**
```
生成2024年1月的考勤表
```

**指定员工：**
```
创建一个考勤表，包含张三、李四、王五三个人，时间是本月
```

**指定格式：**
```
做一个周考勤表，从1月1日到1月7日，需要显示上下班时间和工时
```

**带统计功能：**
```
生成部门月度考勤汇总表，统计迟到早退次数和出勤率
```

**生成图表：**
```
创建本月考勤表并生成出勤率饼图
```

#### 支持的关键词

| 类别 | 关键词示例 |
|------|-----------|
| 时间 | 今天、本周、本月、上月、1月、2024年、1月1日到1月31日 |
| 类型 | 日报、周报、月报、汇总表、统计表 |
| 字段 | 上班时间、下班时间、工时、加班、迟到、早退、请假 |
| 统计 | 出勤率、迟到次数、早退次数、加班时长、请假天数 |
| 图表 | 饼图、柱状图、折线图、趋势图 |

### 2.2 使用模板

如果您不想输入自然语言，可以直接选择预设模板。

#### 预设模板列表

| 模板名称 | 说明 | 适用场景 |
|---------|------|---------|
| 简单日报 | 基础打卡记录 | 每日考勤记录 |
| 详细日报 | 包含工时计算 | 需要统计工时 |
| 标准周报 | 一周考勤汇总 | 周度考勤管理 |
| 弹性工时周报 | 支持弹性上下班 | 弹性工作制 |
| 标准月报 | 月度考勤明细 | 月度考勤管理 |
| 月度汇总 | 统计数据汇总 | 月度考勤分析 |

#### 使用步骤
1. 点击 **选择模板** 按钮
2. 浏览模板列表，点击预览
3. 选择合适的模板
4. 填写必要参数（日期范围、员工等）
5. 点击 **生成**

### 2.3 从文件导入

支持从现有文件导入考勤数据。

#### 支持的文件格式
- CSV 文件 (.csv)
- Excel 文件 (.xlsx, .xls)

#### 导入步骤

1. **选择文件**
   - 点击 **导入文件** 按钮
   - 选择要导入的文件

2. **配置导入选项**
   - 选择是否有表头
   - 设置日期格式
   - 设置时间格式

3. **映射列**
   - 将文件中的列映射到考勤字段
   - 必填字段：员工姓名、日期
   - 可选字段：上班时间、下班时间、状态等

4. **预览数据**
   - 检查导入的数据是否正确
   - 查看错误和警告信息

5. **确认导入**
   - 点击 **确认导入**
   - 选择输出模板
   - 生成考勤表

#### 导入文件格式示例

**CSV 格式：**
```csv
姓名,日期,上班时间,下班时间,状态,备注
张三,2024-01-01,09:00,18:00,正常,
张三,2024-01-02,09:15,18:00,迟到,
李四,2024-01-01,08:55,18:30,正常,加班0.5小时
```

**Excel 格式：**
| 姓名 | 日期 | 上班时间 | 下班时间 | 状态 | 备注 |
|------|------|---------|---------|------|------|
| 张三 | 2024/1/1 | 9:00 | 18:00 | 正常 | |
| 张三 | 2024/1/2 | 9:15 | 18:00 | 迟到 | |

### 2.4 生成图表

可以为考勤数据生成可视化图表。

#### 支持的图表类型

| 图表类型 | 说明 | 适用场景 |
|---------|------|---------|
| 出勤率饼图 | 显示出勤/缺勤/请假比例 | 整体出勤情况 |
| 出勤柱状图 | 按日期显示出勤人数 | 每日出勤趋势 |
| 员工对比图 | 对比各员工出勤情况 | 员工考勤对比 |
| 趋势折线图 | 显示出勤率变化趋势 | 长期趋势分析 |
| 工时统计图 | 显示工时分布 | 工时分析 |

#### 生成步骤
1. 先生成或导入考勤数据
2. 点击 **生成图表** 按钮
3. 选择图表类型
4. 配置图表选项
5. 点击 **插入图表**

---

## 3. 考勤表格式说明

### 3.1 日考勤表

**简单日报格式：**
```
┌────┬────────┬────────┬────────┬──────┐
│序号│  姓名  │上班时间│下班时间│ 状态 │
├────┼────────┼────────┼────────┼──────┤
│ 1  │  张三  │ 09:00  │ 18:00  │ 正常 │
│ 2  │  李四  │ 09:15  │ 18:00  │ 迟到 │
│ 3  │  王五  │   -    │   -    │ 请假 │
└────┴────────┴────────┴────────┴──────┘
```

**详细日报格式：**
```
┌────┬────────┬────────┬────────┬──────┬──────┬──────┬──────┐
│序号│  姓名  │上班时间│下班时间│ 工时 │ 加班 │ 状态 │ 备注 │
├────┼────────┼────────┼────────┼──────┼──────┼──────┼──────┤
│ 1  │  张三  │ 09:00  │ 19:30  │ 9.5h │ 1.5h │ 正常 │      │
│ 2  │  李四  │ 09:15  │ 18:00  │ 7.75h│  -   │ 迟到 │迟到15分│
└────┴────────┴────────┴────────┴──────┴──────┴──────┴──────┘
```

### 3.2 周考勤表

```
┌────────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬──────┐
│  姓名  │ 周一│ 周二│ 周三│ 周四│ 周五│ 周六│ 周日│ 出勤 │
│        │ 1/1 │ 1/2 │ 1/3 │ 1/4 │ 1/5 │ 1/6 │ 1/7 │ 天数 │
├────────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼──────┤
│  张三  │  ✓  │  ✓  │  ✓  │  ✓  │  ✓  │  休 │  休 │  5   │
│  李四  │  ✓  │  迟 │  ✓  │  假 │  ✓  │  休 │  休 │  4   │
│  王五  │  ✓  │  ✓  │  早 │  ✓  │  ✓  │  休 │  休 │  5   │
└────────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴──────┘

图例：✓=正常  迟=迟到  早=早退  假=请假  休=休息
```

### 3.3 月考勤表

```
                    2024年1月考勤表
┌────┬──┬──┬──┬──┬──┬──┬──┬───┬──────┬──────┬──────┬──────┐
│姓名│1 │2 │3 │..│29│30│31│出勤│迟到  │早退  │请假  │加班  │
├────┼──┼──┼──┼──┼──┼──┼──┼───┼──────┼──────┼──────┼──────┤
│张三│✓ │✓ │休│..│✓ │✓ │✓ │22 │ 1次  │ 0次  │ 0天  │ 10h  │
│李四│✓ │迟│休│..│✓ │假│✓ │20 │ 2次  │ 1次  │ 1天  │  5h  │
│王五│✓ │✓ │休│..│早│✓ │✓ │21 │ 0次  │ 2次  │ 0天  │  8h  │
├────┴──┴──┴──┴──┴──┴──┴──┴───┴──────┴──────┴──────┴──────┤
│合计                          │63 │ 3次  │ 3次  │ 1天  │ 23h  │
└─────────────────────────────────┴──────┴──────┴──────┴──────┘
```

### 3.4 汇总统计表

```
                2024年1月考勤汇总表
┌────┬──────┬──────┬──────┬──────┬──────┬──────┬────────┐
│姓名│应出勤│实出勤│迟到  │早退  │请假  │加班  │出勤率  │
├────┼──────┼──────┼──────┼──────┼──────┼──────┼────────┤
│张三│  22  │  22  │ 1次  │ 0次  │ 0天  │ 10h  │ 100%   │
│李四│  22  │  20  │ 2次  │ 1次  │ 1天  │  5h  │ 90.9%  │
│王五│  22  │  21  │ 0次  │ 2次  │ 0天  │  8h  │ 95.5%  │
├────┼──────┼──────┼──────┼──────┼──────┼──────┼────────┤
│合计│  66  │  63  │ 3次  │ 3次  │ 1天  │ 23h  │ 95.5%  │
└────┴──────┴──────┴──────┴──────┴──────┴──────┴────────┘
```

---

## 4. 状态标记说明

### 4.1 考勤状态

| 状态 | 标记 | 说明 |
|------|------|------|
| 正常 | ✓ | 正常出勤 |
| 迟到 | 迟 | 超过上班时间打卡 |
| 早退 | 早 | 早于下班时间打卡 |
| 缺勤 | ✗ | 未打卡且无请假 |
| 请假 | 假 | 已批准的请假 |
| 出差 | 出 | 外出公务 |
| 休息 | 休 | 周末或节假日 |
| 调休 | 调 | 调休日 |

### 4.2 请假类型

| 类型 | 说明 |
|------|------|
| 事假 | 个人事务请假 |
| 病假 | 因病请假 |
| 年假 | 年度带薪假期 |
| 婚假 | 结婚假期 |
| 产假 | 生育假期 |
| 陪产假 | 配偶生育假期 |
| 丧假 | 亲属丧事假期 |

---

## 5. 设置说明

### 5.1 API设置

如果需要使用AI增强的自然语言理解功能：

1. 点击右上角 **设置** 图标
2. 选择 **API设置**
3. 选择API提供商（OpenAI/Azure）
4. 输入API密钥
5. 点击 **测试连接**
6. 保存设置

### 5.2 默认设置

可以配置默认的考勤参数：

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| 工作日 | 每周工作日 | 周一至周五 |
| 上班时间 | 标准上班时间 | 09:00 |
| 下班时间 | 标准下班时间 | 18:00 |
| 迟到阈值 | 超过多少分钟算迟到 | 0分钟 |
| 早退阈值 | 提前多少分钟算早退 | 0分钟 |
| 日期格式 | 日期显示格式 | YYYY-MM-DD |
| 默认模板 | 默认使用的模板 | 标准月报 |

### 5.3 界面设置

| 设置项 | 说明 |
|--------|------|
| 主题 | 浅色/深色/跟随系统 |
| 紧凑模式 | 减少界面间距 |
| 显示提示 | 显示操作提示 |

---

## 6. 常见问题

### Q1: 插件无法加载？
**解决方案：**
- 检查Office版本是否支持（需要Office 2016或更高版本）
- 检查网络连接
- 尝试清除Office缓存后重新加载

### Q2: 自然语言无法正确识别？
**解决方案：**
- 尝试使用更明确的表述
- 使用关键词（如"月报"、"周报"）
- 检查日期格式是否正确
- 如果配置了API，检查API连接是否正常

### Q3: 导入文件失败？
**解决方案：**
- 检查文件格式是否支持
- 确保文件没有被其他程序占用
- 检查文件编码（CSV建议使用UTF-8）
- 确保必填列（姓名、日期）存在

### Q4: 图表无法生成？
**解决方案：**
- 确保已有考勤数据
- 检查数据是否完整
- 在Excel中使用（Word不支持图表）

### Q5: 如何保存自定义模板？
**步骤：**
1. 生成考勤表后，点击 **保存为模板**
2. 输入模板名称和描述
3. 点击 **保存**
4. 模板将出现在"我的模板"中

---

## 7. 快捷操作

| 操作 | 快捷键 |
|------|--------|
| 生成考勤表 | Enter（在输入框中） |
| 打开模板选择 | Ctrl + T |
| 导入文件 | Ctrl + I |
| 打开设置 | Ctrl + , |
| 插入到文档 | Ctrl + Enter |

---

## 8. 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 支持自然语言生成考勤表
- 支持Excel和Word
- 支持文件导入（CSV/Excel）
- 支持图表生成
- 预设6种考勤表模板